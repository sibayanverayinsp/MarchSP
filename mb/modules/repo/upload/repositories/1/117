function validate(f){for(var i=0;i<f.elements.length;i++){var element=f.elements[i];if(element.value==""){element.focus();alert("Please fill up the form before submitting");return false;}}if(f.password.value!=f.cpassword.value)alert("Passwords did not match.");else{$.post($(f).attr('action'),$(f).serialize(),function(data){$('#username3').append("<option value='"+f.username.value+"' id='option_"+f.username.value+"'>"+f.username.value+" | "+f.role.value+"</option>");$('#username4').append("<option value='"+f.username.value+"' id='option2_"+f.username.value+"'>"+f.username.value+" | "+f.role.value+"</option>");alert("Account successfully created!");f.reset();});}return false;}function validate2(f){$.post($(f).attr('action'),$(f).serialize(),function(data){$('#score_row_'+(f.username.value)).remove();$('#option2_'+(f.username.value)).remove();$('#option_'+(f.username.value)).remove();alert("Account successfully deleted!");});return false;}function validate3(f){$.post($(f).attr('action'),$(f).serialize(),function(data){alert("Password successfully changed!");f.reset();});return false;}function poll3(models2){if($("#score_table")==undefined)return;var models2=models2;$.post('ajax/?get_score',{},function(data){if(data=="" || data==undefined)return;var json2=JSON.parse(data);var json=json2.data;var models=models2.data;for(var j=0;j<json.length;j++){for(var i=0;i<models.length;i++){if(json[j].sender==models[i].sender && json[j].score!=models[i].score){$('#score_'+json[j].sender).html(json[j].score);$('#score_date_'+json[j].sender).html(new Date().toLocaleTimeString());break;}else if(json[j].sender==models[i].sender)break;}if(i==models.length){$("#score_table").append(" <tr id='score_row_"+json[j].sender+"'> <td>"+json[j].sender+"</td> <td id='score_"+json[j].sender+"'>"+json[j].score+"</td> <td id='score_date_"+json[j].sender+"'>"+new Date().toLocaleTimeString()+"</td> </tr> ");}}models2=json2;setTimeout(function(){poll3(models2)},5000);});};function eliminate(e){$.post('ajax/?eliminate',{type:e.id},function(data,textStatus,jqXHR){if(jqXHR.status==200){data=JSON.parse(data);if(data['message'].length > 5)alert(data['message']);else{$('#eliminatorTable').empty();for(i=0;i<data.items;i++){d=data.data[i];$('#eliminatorTable').append(" <tr> <td> <div class='question'> <form method='POST' onsubmit='return showNext(this)'> <input type='hidden' value='"+d['questionID']+"' name='id' /> <input type='hidden' name='answer'/> <table> <tr> <td colspan='2' class='q'>Question #"+(i+1)+"<td> </tr> <tr> <td colspan='2' class='q'>"+d['question']+"</td> </tr> <tr> <td width='50%'><input type='submit' value='"+d['choiceA']+"' onclick='this.form.answer.value=\"A\"' /></td> <td width='50%'><input type='submit' value='"+d['choiceB']+"' onclick='this.form.answer.value=\"B\"' /></td> </tr> <tr> <td width='50%'><input type='submit' value='"+d['choiceC']+"' onclick='this.form.answer.value=\"C\"' /></td> <td width='50%'><input type='submit' value='"+d['choiceD']+"' onclick='this.form.answer.value=\"D\"' /></td> </tr> </table> </form> </div> </td> </tr> ");}}}else{alert("Something went wrong:(");}});}function showNext(f){$(f).parent().parent().parent().remove();$.post('ajax/?scorepp',{QID:f.id.value,answer:f.answer.value},function(data,textStatus,jqXHR){if(jqXHR.status==200){}else{alert("Something went wrong:(");}});return false;}function changeButtonValue(b){$('#sudo-file').val(($(b).val()=='')?"SELECT A FILE":($(b).val()).split(/(\\|\/)/g).pop());}function startUpload(){var ext=$('#file').val().split('.').pop();if($('#file').val()=="")alert("Please select a file first.");else if(ext!="c" && ext!="cpp" && ext!="java")alert("Wrong file type!");else if(confirm("Are you sure this is your solution for problem "+$('#problems').val()+"?")){changeButtonValue($('#file'));$('#result').html("<img src='static/images/loader.gif' />");return true;}return false;}function stopUpload(success,id){var result='';if(success==1){$('#result').html('<span class="msg">The file was uploaded successfully!</span>');$('#files_table').append(" <tr> <th>"+$('#problems')[0].value+"</th> <th id='sender_row_"+id+"'>PENDING</th> </tr> ");document.getElementById('uploadForm').reset();}else if(success==5){$('#result').empty();alert('Please wait for your solution in this problem to be evaluated before sending another. Meanwhile you can continue solving other problems.');}else if(success==2)$('#result').html('<span class="emsg">Wrong file type!</span>');else if(success==4)$('#result').html('<span class="emsg">File size too large. File must not exceed 50kB.</span>');else $('#result').html('<span class="emsg">There was an error during file upload. Please try again</span>');setTimeout(function(){$('#result').fadeOut(5000);},3000);changeButtonValue($('#file'));return true;}function poll2(){if($("#files_table")==undefined)return;var models=models;$.post('ajax/?get_notifs',{},function(data){if(data=="" || data==undefined){alert();return;}var json=JSON.parse(data);if(json!=undefined){var a=json.data;if(a.toString()!="")for(b in a){$("#sender_row_"+a[b].fileId).html("<span class='"+((a[b].status=='Correct')?'':((a[b].status=='CHECKING')?'p':'e'))+"msg'>"+a[b].status+"</span>");if(a[b].status=='Correct')$('#problem_option_'+a[b].problemNo).remove();}changeButtonValue($('#file'));setTimeout(function(){poll2()},5000);}});};function checkChecking(){$.post('ajax/?checking',{},function(data,textStatus,jqXHR){if(jqXHR.status==200){data=JSON.parse(data);data=data.data[0];console.log(data);$('#stash_id').val(data.fileId);$('#stash_ext').val(data.ext);$('.download_button').attr('disabled','disabled');$('#submitButton').removeAttr('disabled');setCode(data.fileId);if(confirm('You left something to evaluate. Download the file again?'))window.location='ajax/?download&id='+$('#stash_id').val()+'&ext='+$('#stash_ext').val();}else{console.log(jqXHR);alert('Something went wrong:(');}})}function evaluateFile(){if(confirm("Are you sure you want to judge this solution as "+$('#file_eval').val()+"?")){$.post('ajax/?eval_file',{fileId:$('#stash_id').val(),eval:$('#file_eval').val()},function(data,textStatus,jqXHR){if(jqXHR.status==200){$('#code_area').html('');$('.download_button').removeAttr('disabled');$('#submitButton').attr('disabled','disabled');alert('Solution successfully evaluated.');}else{console.log(jqXHR);alert('Something went wrong:(');}});}}function getFile(f){$('.download_button').attr('disabled','disabled');$('#submitButton').removeAttr('disabled');$.post($(f).attr('action'),$(f).serialize(),function(data,textStatus,jqXHR){if(jqXHR.status==200){if(data=="1"){window.location='ajax/?download&id='+$('#stash_id').val()+'&ext='+$('#stash_ext').val();}else alert('Someone else is already checking this solution.');$('#stash_row_'+$('#stash_id').val()).fadeOut('slow');}else{console.log(jqXHR);alert('Something went wrong:(');}});return false;}function stashHover(){$('.stash_row').click(function(){$('.activeRow').removeClass('activeRow');$(this).addClass('activeRow');var id=($(this)[0].id).substr(10,($(this)[0].id).length);setCode(id);});}function setCode(id){$.post('ajax/?get_code',{fileId:id},function(data,textStatus,jqXHR){if(jqXHR.status==200){$('#code_area').html(data);}else{console.log(jqXHR);alert('Something went wrong:(');}});}function bago(luma,bago){if(luma.length==0)return bago;_q=new Array;for(var i=0;i<bago.length;i++){for(var j=0;j<luma.length;j++)if(JSON.stringify(bago[i])==JSON.stringify(luma[j]))break;if(j==luma.length)_q.push(bago[i]);}return _q;}function lana(luma,bago){_q=new Array;for(var j=0;j<luma.length;j++){for(var i=0;i<bago.length;i++)if(JSON.stringify(bago[i])==JSON.stringify(luma[j]))break;if(i==bago.length)_q.push(luma[j].fileId);}return _q;}function poll(models){if($("#stash_table")==undefined)return;var models=models;$.post('ajax/?get_stash',{},function(data,textStatus,jqXHR){if(jqXHR.status==200){if(data=="" || data==undefined)return;var json=JSON.parse(data);var a=bago(models.data,json.data);var maychinecheckan=$('#submitButton').attr('disabled')=='disabled'?false:true;if(a.toString()!=""){for(b in a)$("#stash_table").append(" <tr id='stash_row_"+a[b].fileId+"' class='stash_row'> <td>"+a[b].fileId+"</td> <td>"+a[b].sender+"</td> <td>Problem "+a[b].problemNo+"</td> <td>"+a[b].version+"</td> <td><input type='submit' class='download_button' value='DOWNLOAD AND CHECK' onclick=\"$('#stash_id').val('"+a[b].fileId+"');$('#stash_ext').val('"+a[b].ext+"');\" "+((maychinecheckan)?"disabled='disabled'":"")+"></td> </tr> ");stashHover();}var a=lana(models.data,json.data);if(a.toString()!="")for(b in a)$('#stash_row_'+a[b]).fadeOut('slow');models=json;setTimeout(function(){poll(models)},5000);}else{console.log(jqXHR);return;}});};$(document).delegate("#logoutButton","click",function(){$.post('ajax/?logout',{},function(data){showDivs('hide','logout');$(".winNail").remove();});});function validateLogin(f){for(var i=0;i<f.elements.length;i++){var e=f.elements[i];if(e.type!='submit' && e.value==""){e.focus();alert("Please input username and password before logging in");return false;}}$.post($(f).attr('action'),$(f).serialize(),function(data,textStatus,jqXHR){if(jqXHR.status==200){if(data!="0"){$('#login_div').animate({"left":"-1500px"},{duration:"slow",complete:function(){loadPage(data);}});}else alert("Incorrect username or password");}else{alert("Something went wrong:(");}});return false;}function clickIE(){if(document.all)return false;}function clickNS(e){if(document.layers||(document.getElementById&&!document.all))if(e.which==2||e.which==3)return false;}if(document.layers){document.captureEvents(Event.MOUSEDOWN);document.onmousedown=clickNS;}else{document.onmouseup=clickNS;document.oncontextmenu=clickIE;}document.oncontextmenu=new Function("return false");function loadPage(data){$('#center').load("index.php?start",function(responseText,textStatus,XMLHttpRequest){if(data!='')$('#footer').css({visibility:'visible'});else $('#footer').css({visibility:'hidden'});dragResize();showDivs('show');if(data=="Admin")poll3({data:""});else if(data=="Team")poll2();else if(data=="Judge"){poll({data:""});checkChecking();}else $('#username').focus();});}function dragResize(){$(function(){$(".window").draggable({cancel:'.window_content',containment:'body',scroll:false,stack:{group:'.window',min:1}});});$(function(){$(".window").resizable({handles:'n,e,s,w,ne,se,sw,nw',containment:'body',minHeight:80,minWidth:138,maxHeight:$(window).height(),maxWidth:$(window).width()});});$(function(){$(".window_title button").html('------');$(".window_title button").click(function(e){var id=$(e.toElement).parent().parent()[0].id;if(id=='login_div')return;function addThumb(){$('#list').append("<div class='opened tunggal winNail' id='thumb_"+id+"'></div>");}$(e.toElement).parent().parent().effect("transfer",{to:"#thumb_"+$(e.toElement).parent().parent()[0].id,className:"ui-effects-transfer"},1000,addThumb()).hide();});$(document).delegate(".winNail","click",function(){id=($(this)[0].id).substr(6,($(this)[0].id).length);$('#'+id).show();$(this).remove();});});}function showDivs(mode,todo){var effects=new Array('top','left');var divs=$(".window");function showDiv(sub,i){if(sub==divs.length)return;var div=divs[sub];if(mode=='show'){var temp=$(div).css(effects[i]);eval("$(div).css({"+effects[i]+":'"+(Math.round(Math.random())==0?'+':'-')+"1500px','visibility':'visible'});");eval("$(div).animate({"+effects[i]+":temp},'slow');");}else eval("$(div).animate({"+effects[i]+":'1500px'},'slow');");setTimeout(function(){showDiv(sub+1,(i+1)%effects.length);},800);}showDiv(0,Math.round(Math.random()));if(todo=='logout')setTimeout(function(){$('#footer').css({visibility:'hidden'});loadPage('');},1000);}function update(){var m=document.getElementById('time');if(time.sec<59)time.sec++;else{time.sec=0;if(time.min<59)time.min++;else{time.min=0;if(time.hour<12){time.hour++;if(time.hour==12)time.meridian=(time.meridian=="am")?"pm":"am";}else time.hour=1;}}sec=(time.sec<10)?"0"+time.sec:""+time.sec;min=(time.min<10)?"0"+time.min:""+time.min;hr=(time.hour<10)?"0"+time.hour:""+time.hour;m.innerHTML="<span id='hour'>"+hr+"</span>:<span id='min'>"+min+"</span>:<span id='sec'>"+sec+"</span> <span id='meri'>"+time.meridian+"</span>";}setInterval('update()',1000);loadPage('');